<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ ç°¡æ˜“è–èª•ç¦®ç‰©äº¤æ›éŠæˆ² - å–®é ç‰ˆ ğŸ</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Microsoft JhengHei', sans-serif;
    background: linear-gradient(135deg, #1a472a 0%, #d42426 100%);
    color: white;
    text-align: center;
    padding: 20px;
    min-height: 100vh;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
  }
  .card {
    background: white;
    color: #333;
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  .btn {
    background: #d42426;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 25px;
    font-size: 16px;
    cursor: pointer;
    margin: 10px;
    font-weight: bold;
  }
  .btn:hover {
    background: #b01d1f;
  }
  .gift {
    display: inline-block;
    width: 120px;
    height: 120px;
    margin: 10px;
    position: relative;
    cursor: pointer;
    transition: transform 0.3s;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    border-radius: 10px;
    overflow: hidden;
  }
  .gift:hover {
    transform: scale(1.05);
  }
  .gift-inner {
    width: 100%;
    height: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .gift.flipped .gift-inner {
    transform: rotateY(180deg);
  }
  .gift-front, .gift-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px;
  }
  .gift-back {
    transform: rotateY(180deg);
    background: white;
    color: #333;
  }
  .gift-icon {
    font-size: 40px;
  }
  .hidden {
    display: none;
  }
  .snowflake {
    position: fixed;
    color: white;
    font-size: 20px;
    animation: fall linear infinite;
    pointer-events: none;
  }
  @keyframes fall {
    to { transform: translateY(100vh); }
  }
  .player-input {
    margin-bottom: 15px;
  }
  .player-input label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
  }
  .player-input input {
    width: 100%;
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #ddd;
  }
  .gift-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 15px;
    margin-top: 20px;
  }
  .result-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
  }
  .result-table th, .result-table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #eee;
  }
  .result-table th {
    background: #f8f8f8;
  }
  .bg-1 { background: linear-gradient(45deg, #ff9a9e, #fad0c4); }
  .bg-2 { background: linear-gradient(45deg, #a18cd1, #fbc2eb); }
  .bg-3 { background: linear-gradient(45deg, #84fab0, #8fd3f4); }
  .bg-4 { background: linear-gradient(45deg, #fa709a, #fee140); }
  .bg-5 { background: linear-gradient(45deg, #30cfd0, #330867); }
  .bg-6 { background: linear-gradient(45deg, #4481eb, #04befe); }
  .bg-7 { background: linear-gradient(45deg, #e8198b, #c7eafd); }
  .bg-8 { background: linear-gradient(45deg, #22E1FF, #625EB1); }
</style>
</head>
<body>
<div id="snowflakes"></div>
<div class="container">
  <h1>ğŸ„ ç°¡æ˜“è–èª•ç¦®ç‰©äº¤æ›éŠæˆ² ğŸ</h1>
  <p>å–®é ç‰ˆ - ä¸éœ€è¦æˆ¿é–“ä»£ç¢¼ï¼</p>
  
  <!-- æ­¥é©Ÿ1ï¼šè¨­ç½®ç©å®¶ -->
  <div id="step1" class="card">
    <h2 style="color:#d42426; margin-bottom:20px;">ğŸ‘¥ è¼¸å…¥åƒèˆ‡è€…è³‡è¨Š</h2>
    
    <div id="playerInputs">
      <div class="player-input">
        <label>ç©å®¶1 åç¨±ï¼š</label>
        <input type="text" id="player1" placeholder="ä¾‹å¦‚ï¼šåª½åª½">
      </div>
      <div class="player-input">
        <label>ç©å®¶1 ç¦®ç‰©æè¿° (é—œéµå­—)ï¼š</label>
        <input type="text" id="gift1" placeholder="ä¾‹å¦‚ï¼šå·§å…‹åŠ›ã€ç”œé»ã€æ‰‹å·¥è£½ä½œ">
      </div>
    </div>
    
    <div style="margin:15px 0;">
      <button class="btn" onclick="addPlayer()">+ æ–°å¢ç©å®¶</button>
      <button class="btn" onclick="removePlayer()" id="removeBtn" disabled>- ç§»é™¤ç©å®¶</button>
    </div>
    
    <button class="btn" style="background:#28a745; padding:12px 30px; margin-top:10px;" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
  </div>
  
  <!-- æ­¥é©Ÿ2ï¼šéŠæˆ²ç•«é¢ -->
  <div id="step2" class="card hidden">
    <h2 style="color:#d42426; margin-bottom:20px;">ğŸ® ç¦®ç‰©äº¤æ›éŠæˆ²</h2>
    <p>è¼ªæµé»æ“Šç¦®ç‰©ï¼Œçœ‹çœ‹èª°æœƒå¾—åˆ°ä»€éº¼ï¼</p>
    
    <div style="background:#e9f5ff; color:#0066cc; padding:15px; border-radius:8px; margin:15px 0; text-align:left;">
      <strong>éŠæˆ²è¦å‰‡ï¼š</strong>
      <ol style="margin-left:20px; margin-top:5px;">
        <li>æ¯ä½ç©å®¶è¼ªæµé¸æ“‡ä¸€å€‹ç¦®ç‰©</li>
        <li>é¸æ“‡å¾Œæœƒé¡¯ç¤ºç¦®ç‰©å…§å®¹</li>
        <li>æ‰€æœ‰ç¦®ç‰©é¸å®Œå¾Œï¼ŒéŠæˆ²çµæŸ</li>
      </ol>
    </div>
    
    <div style="background:#d42426; color:white; padding:10px; border-radius:8px; margin:15px 0;">
      <h3 id="currentPlayer">ç¾åœ¨æ˜¯ ç©å®¶1 çš„å›åˆ</h3>
    </div>
    
    <div id="giftGrid" class="gift-grid"></div>
  </div>
  
  <!-- æ­¥é©Ÿ3ï¼šçµæœ -->
  <div id="step3" class="card hidden">
    <h2 style="color:#d42426; margin-bottom:20px;">ğŸŠ éŠæˆ²çµæœ ğŸŠ</h2>
    
    <table class="result-table">
      <thead>
        <tr>
          <th>ç©å®¶</th>
          <th>ç²å¾—çš„ç¦®ç‰©</th>
        </tr>
      </thead>
      <tbody id="resultBody"></tbody>
    </table>
    
    <button class="btn" onclick="resetGame()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
  </div>
</div>

<script>
let playerCount = 2;
let players = [];
let gifts = [];
let currentPlayerIndex = 0;
let results = [];
let colors = ['bg-1', 'bg-2', 'bg-3', 'bg-4', 'bg-5', 'bg-6', 'bg-7', 'bg-8'];

// åˆå§‹åŒ–é›ªèŠ±æ•ˆæœ
function createSnow() {
  const container = document.getElementById('snowflakes');
  for (let i = 0; i < 30; i++) {
    const s = document.createElement('div');
    s.className = 'snowflake';
    s.textContent = ['â„ï¸', 'âœ¨', 'â­'][Math.floor(Math.random() * 3)];
    s.style.left = Math.random() * 100 + '%';
    s.style.top = -20 + 'px';
    s.style.animationDuration = (Math.random() * 4 + 3) + 's';
    s.style.opacity = Math.random() * 0.6 + 0.4;
    container.appendChild(s);
  }
}

// æ·»åŠ ç©å®¶è¼¸å…¥æ¬„ä½
function addPlayer() {
  playerCount++;
  const playerInputs = document.getElementById('playerInputs');
  
  const playerDiv = document.createElement('div');
  playerDiv.className = 'player-input';
  playerDiv.innerHTML = `<label>ç©å®¶${playerCount} åç¨±ï¼š</label><input type="text" id="player${playerCount}" placeholder="ä¾‹å¦‚ï¼šç©å®¶${playerCount}">`;
  
  const giftDiv = document.createElement('div');
  giftDiv.className = 'player-input';
  giftDiv.innerHTML = `<label>ç©å®¶${playerCount} ç¦®ç‰©æè¿° (é—œéµå­—)ï¼š</label><input type="text" id="gift${playerCount}" placeholder="ä¾‹å¦‚ï¼šç¦®ç‰©æè¿°">`;
  
  playerInputs.appendChild(playerDiv);
  playerInputs.appendChild(giftDiv);
  
  document.getElementById('removeBtn').disabled = false;
}

// ç§»é™¤ç©å®¶è¼¸å…¥æ¬„ä½
function removePlayer() {
  if (playerCount <= 2) return;
  
  const playerInputs = document.getElementById('playerInputs');
  playerInputs.removeChild(playerInputs.lastChild);
  playerInputs.removeChild(playerInputs.lastChild);
  
  playerCount--;
  if (playerCount <= 2) {
    document.getElementById('removeBtn').disabled = true;
  }
}

// é–‹å§‹éŠæˆ²
function startGame() {
  // æ”¶é›†ç©å®¶è³‡è¨Š
  players = [];
  gifts = [];
  results = [];
  
  for (let i = 1; i <= playerCount; i++) {
    const nameInput = document.getElementById(`player${i}`);
    const giftInput = document.getElementById(`gift${i}`);
    
    const name = nameInput.value.trim() || `ç©å®¶${i}`;
    const giftDesc = giftInput.value.trim() || `ç¥ç§˜ç¦®ç‰©${i}`;
    
    players.push({
      id: i,
      name: name
    });
    
    gifts.push({
      id: i,
      ownerId: i,
      ownerName: name,
      description: giftDesc,
      color: colors[(i-1) % colors.length],
      selected: false,
      selectedBy: null
    });
  }
  
  // æª¢æŸ¥ç©å®¶æ•¸é‡
  if (players.length < 2) {
    alert('è‡³å°‘éœ€è¦2åç©å®¶æ‰èƒ½é–‹å§‹éŠæˆ²ï¼');
    return;
  }
  
  // é¡¯ç¤ºéŠæˆ²ç•«é¢
  document.getElementById('step1').classList.add('hidden');
  document.getElementById('step2').classList.remove('hidden');
  
  // åˆå§‹åŒ–éŠæˆ²
  currentPlayerIndex = 0;
  updateGameUI();
}

// æ›´æ–°éŠæˆ²UI
function updateGameUI() {
  // æ›´æ–°ç•¶å‰ç©å®¶
  document.getElementById('currentPlayer').textContent = `ç¾åœ¨æ˜¯ ${players[currentPlayerIndex].name} çš„å›åˆ`;
  
  // æ›´æ–°ç¦®ç‰©ç¶²æ ¼
  const giftGrid = document.getElementById('giftGrid');
  giftGrid.innerHTML = '';
  
  gifts.forEach((gift, index) => {
    if (gift.selected) return;
    
    const giftDiv = document.createElement('div');
    giftDiv.className = `gift ${gift.color}`;
    giftDiv.innerHTML = `
      <div class="gift-inner">
        <div class="gift-front">
          <div class="gift-icon">ğŸ</div>
          <div style="margin-top:5px;">ç¦®ç‰© ${gift.id}</div>
        </div>
        <div class="gift-back">
          <strong>${gift.ownerName} çš„ç¦®ç‰©</strong>
          <div style="margin-top:5px;">${gift.description}</div>
        </div>
      </div>
    `;
    
    giftDiv.onclick = () => selectGift(index);
    giftGrid.appendChild(giftDiv);
  });
}

// é¸æ“‡ç¦®ç‰©
function selectGift(index) {
  const gift = gifts[index];
  if (gift.selected) return;
  
  gift.selected = true;
  gift.selectedBy = players[currentPlayerIndex].id;
  
  // æ·»åŠ åˆ°çµæœ
  results.push({
    player: players[currentPlayerIndex].name,
    gift: gift
  });
  
  // é¡¯ç¤ºç¦®ç‰©å…§å®¹
  const giftElements = document.querySelectorAll('.gift');
  giftElements[index].classList.add('flipped');
  
  // å»¶é²å¾Œé€²å…¥ä¸‹ä¸€å›åˆ
  setTimeout(() => {
    currentPlayerIndex++;
    
    // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰ç¦®ç‰©éƒ½è¢«é¸å®Œæˆ–æ‰€æœ‰ç©å®¶éƒ½é¸é
    if (currentPlayerIndex >= players.length || results.length >= gifts.length) {
      showResults();
    } else {
      updateGameUI();
    }
  }, 1500);
}

// é¡¯ç¤ºçµæœ
function showResults() {
  document.getElementById('step2').classList.add('hidden');
  document.getElementById('step3').classList.remove('hidden');
  
  const resultBody = document.getElementById('resultBody');
  resultBody.innerHTML = '';
  
  results.forEach(result => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td><strong>${result.player}</strong></td>
      <td>${result.gift.ownerName} çš„ç¦®ç‰©: ${result.gift.description}</td>
    `;
    resultBody.appendChild(row);
  });
}

// é‡ç½®éŠæˆ²
function resetGame() {
  document.getElementById('step3').classList.add('hidden');
  document.getElementById('step1').classList.remove('hidden');
}

// åˆå§‹åŒ–
createSnow();
</script>
</body>
</html>
